<!DOCTYPE html>
<html lang="en" ng-app="docs">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
      <title>Collections - Deployd Docs</title>
    
    <link href='http://fonts.googleapis.com/css?family=Bitter:400,700,400italic' rel='stylesheet' type='text/css'>
    <link href="../stylesheets/style.css" rel='stylesheet' type='text/css'>
    <link href="../stylesheets/prettify.css" rel='stylesheet' type='text/css'>
    <script src="../javascripts/libs/angular.js"></script>
    <script src="../javascripts/libs/angular-sanitize.js"></script>
    <script src="../javascripts/libs/jquery-1.8.2.js"></script>
    <script src="../javascripts/libs/bootstrap.js"></script>
    <script src="../javascripts/libs/jquery.highlight.js"></script>
    <script src="../javascripts/libs/jquery.masonry.js"></script>
    <script src="../javascripts/libs/prettify.js"></script>
    
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-27539606-3']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </head>
  
  
  <body>
    <div class="navbar navbar-static-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand" href="http://deployd.com">
            <img src="http://deployd.com/img/logo-text.png">
          </a>
          <div class="nav-collapse">
            <ul class="nav">
              <!--<li><a href="http://cloud.deployd.com">cloud</a></li>-->
              <li class="active"><a href="http://docs.deployd.com">docs</a></li>
              <li><a href="http://deployd.com/community.html">community</a></li>
              <li><a href="http://deployd.com/blog.html">blog</a></li>
            </ul>
          </div><!--/.nav-collapse -->
          
          <div id="search" ng-controller="SearchCtrl" class="pull-right">
  <form class="navbar-search">
    <input value="" placeholder="search docs" id="search-input" type="text" ng-change="change()" ng-model="input" />
  </form>
  <ul id="search-terms" class="typeahead unstyled" ng-show="terms.length" ng-cloak>
    <li ng-repeat="term in terms" class="{{ term.active && 'active' }}" ng-click="choose($index)">
      {{ term.title || term.reference }}
    </li>
  </ul>
</div>

<script src="../javascripts/search.js"></script>
          
          <div id="social" class="nav-collapse pull-left">
            <ul class="nav">
              <li><iframe allowtransparency="true" frameborder="0" scrolling="no" src="http://platform.twitter.com/widgets/tweet_button.1354270846.html#_=1354747685285&count=horizontal&id=twitter-widget-0&lang=en&original_referer=http:/deployd.com/&size=m&text=Deployd%20Platform%20(@deploydapp)%20-%20The%20simplest%20way%20to%20build%20APIs.&url=http:/www.deployd.com" class="twitter-share-button twitter-count-horizontal" style="width: 107px; height: 20px;" title="Twitter Tweet Button" data-twttr-rendered="true"></iframe>
      <script type="text/javascript" async="" src="http://www.google-analytics.com/ga.js"></script><script id="twitter-wjs" src="http://platform.twitter.com/widgets.js"></script><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="navbar navbar-static-top secondary-nav">
      <div class="navbar-inner">
        <div class="container">
          <ul class="nav">        
            <li class=""><a href="../index.html">home</a></li>
            <li class="" ><a href="../guides.html">guides</a></li>
            <li class=""><a href="../api.html">api</a></li>
            <li class=""><a href="../examples/index.html">examples</a></li>
            <li class=""><a href="../modules.html">modules</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container">
      

<ul id="breadcrumb" class="unstyled">

  <li><a href="../index.html">Docs</a><span>/</span></li>

  <li>Collections</li>
  
</ul>

<div id="browser" class="row">
  <div id="sidebar" class="span3">
    

<div id="explorer">
  <ul id="files" class="nav">
    
      <li class=""><a href="collections/creating-collections.md.html"><i class="icon-file"></i> <span>Creating Collections</span></a></li>
    
      <li class=""><a href="collections/accessing-collections.md.html"><i class="icon-file"></i> <span>Accessing Collections with dpd.js</span></a></li>
    
      <li class=""><a href="collections/adding-logic.md.html"><i class="icon-file"></i> <span>Adding Custom Business Logic with Events</span></a></li>
    
      <li class=""><a href="collections/relationships-between-collections.md.html"><i class="icon-file"></i> <span>Relationships Between Collections with Events</span></a></li>
    
      <li class=""><a href="collections/notifying-clients.md.html"><i class="icon-file"></i> <span>Notifying the Client of Changes with Messages</span></a></li>
    
    
  </ul>
  
  <ul id="dirs" class="nav">
  
      <li class=""><a href="collections/advanced-guides/custom-client.md.html"><i class="icon-folder-close"></i> <span>Advanced Guides</span></a></li>
    
      <li class=""><a href="collections/reference/event-api.md.html"><i class="icon-folder-close"></i> <span>Reference</span></a></li>
    
      <li class=""><a href="collections/examples/a-simple-todo-app.md.html"><i class="icon-folder-close"></i> <span>Examples</span></a></li>
    
  </ul>
  
</div>


    
      <h4>Related APIs</h4>
      <div id="related-apis">
        <div id="api">
  
      
        
            <ul class="nav nav-list collections">
              <li class="nav-header"><a href="collections/reference/event-api.md.html">Event API</a></li>
            
      <li><a href="collections/reference/event-api.md.html#s-this-764">this</a></li>
    
      <li><a href="collections/reference/event-api.md.html#s-me-764">me</a></li>
    
      <li><a href="collections/reference/event-api.md.html#s-isMe()-764">isMe()</a></li>
    
      <li><a href="collections/reference/event-api.md.html#s-query-764">query</a></li>
    
      <li><a href="collections/reference/event-api.md.html#s-cancel()-764">cancel()</a></li>
    
      <li><a href="collections/reference/event-api.md.html#s-cancelIf(),%20cancelUnless()-764">cancelIf(), cancelUnless()</a></li>
    
      <li><a href="collections/reference/event-api.md.html#s-error()-764">error()</a></li>
    
      <li><a href="collections/reference/event-api.md.html#s-errorIf(),%20errorUnless()-764">errorIf(), errorUnless()</a></li>
    
      <li><a href="collections/reference/event-api.md.html#s-hide()-764">hide()</a></li>
    
      <li><a href="collections/reference/event-api.md.html#s-protect()-764">protect()</a></li>
    
      <li><a href="collections/reference/event-api.md.html#s-changed()-764">changed()</a></li>
    
      <li><a href="collections/reference/event-api.md.html#s-previous-764">previous</a></li>
    
      <li><a href="collections/reference/event-api.md.html#s-emit()-764">emit()</a></li>
    
      <li><a href="collections/reference/event-api.md.html#s-internal-764">internal</a></li>
    
      <li><a href="collections/reference/event-api.md.html#s-isRoot-764">isRoot</a></li>
    
      <li><a href="collections/reference/event-api.md.html#s-console.log()-764">console.log()</a></li>
    
            </ul>
            
            <ul class="nav nav-list collections">
              <li class="nav-header"><a href="collections/reference/querying-collections.md.html">Querying Collections</a></li>
            
      <li><a href="collections/reference/querying-collections.md.html#s-Comparison%20($gt,%20$lt,%20$gte,%20$lte)-1556">Comparison ($gt, $lt, $gte, $lte)</a></li>
    
      <li><a href="collections/reference/querying-collections.md.html#s-$ne%20(Not%20Equal)-1556">$ne (Not Equal)</a></li>
    
      <li><a href="collections/reference/querying-collections.md.html#s-$in-1556">$in</a></li>
    
      <li><a href="collections/reference/querying-collections.md.html#s-$regex-1556">$regex</a></li>
    
      <li><a href="collections/reference/querying-collections.md.html#s-$fields-1416">$fields</a></li>
    
      <li><a href="collections/reference/querying-collections.md.html#s-$or-1416">$or</a></li>
    
      <li><a href="collections/reference/querying-collections.md.html#s-$sort-1416">$sort</a></li>
    
      <li><a href="collections/reference/querying-collections.md.html#s-$limit-1416">$limit</a></li>
    
      <li><a href="collections/reference/querying-collections.md.html#s-$skip-1416">$skip</a></li>
    
      <li><a href="collections/reference/querying-collections.md.html#s-$limitRecursion-1416">$limitRecursion</a></li>
    
            </ul>
            
            <ul class="nav nav-list collections">
              <li class="nav-header"><a href="collections/reference/updating-objects.md.html">Updating Objects in Collections</a></li>
            
      <li><a href="collections/reference/updating-objects.md.html#s-$inc-3004">$inc</a></li>
    
      <li><a href="collections/reference/updating-objects.md.html#s-$push-3004">$push</a></li>
    
      <li><a href="collections/reference/updating-objects.md.html#s-$pushAll-3004">$pushAll</a></li>
    
      <li><a href="collections/reference/updating-objects.md.html#s-$pull-3004">$pull</a></li>
    
      <li><a href="collections/reference/updating-objects.md.html#s-$pullAll-3004">$pullAll</a></li>
    
            </ul>
            
            <ul class="nav nav-list collections">
              <li class="nav-header"><a href="collections/reference/dpd-js.md.html">Using dpd.js</a></li>
            
      <li><a href="collections/reference/dpd-js.md.html#s-.get(%5Bid%5D,%20%5Bquery%5D,%20fn)-1286">.get([id], [query], fn)</a></li>
    
      <li><a href="collections/reference/dpd-js.md.html#s-.post(%5Bid%5D,%20object,%20fn)">.post([id], object, fn)</a></li>
    
      <li><a href="collections/reference/dpd-js.md.html#s-.put(%5Bid%20or%20query%5D,%20object,%20fn)">.put([id or query], object, fn)</a></li>
    
      <li><a href="collections/reference/dpd-js.md.html#s-.del(id%20or%20query,%20fn)">.del(id or query, fn)</a></li>
    
      <li><a href="collections/reference/dpd-js.md.html#s-dpd.on(message,%20fn)-1069">dpd.on(message, fn)</a></li>
    
      <li><a href="collections/reference/dpd-js.md.html#s-dpd.off(message,%20%5Bfn%5D)-1069">dpd.off(message, [fn])</a></li>
    
      <li><a href="collections/reference/dpd-js.md.html#s-dpd.once(message,%20fn)-1069">dpd.once(message, fn)</a></li>
    
      <li><a href="collections/reference/dpd-js.md.html#s-dpd.socketReady(fn)-1069">dpd.socketReady(fn)</a></li>
    
      <li><a href="collections/reference/dpd-js.md.html#s-dpd.socket-1069">dpd.socket</a></li>
    
            </ul>
            
      
    
</div>




      </div>
    
  </div>
  <div class="span9 sections">
    
      
      
        

  <div class="section"><a name="s-Creating Collections"></a><h2>Creating Collections <a class="anchor-link" href="collections-include=all.html#s-Creating%20Collections">#</a></h2>

<p>A Collection exposes a database-like API directly to clients over HTTP and WebSockets. Clients can run advanced queries, create and update objects, and listen for realtime messages to sync with the Collection when it updates. You can create a Collection in the dashboard by clicking the "Resources +" button in the sidebar, and choosing "Collection".</p><div class="section"><a name="s-Properties-1996"></a><h3>Properties <a class="anchor-link" href="collections-include=all.html#s-Properties-1996">#</a></h3>

<p>Every Collection requires a set of properties that describe the data it can store. By default every object in a Collection is created with an <code>id</code>. If an object being <code>POST</code>ed or <code>PUT</code> into a Collection includes properties or values that don't match what the collection allows, they will be ignored. The following property types are available when creating a Collection:</p>

<ul>
<li><code>String</code> - Acts like a JavaScript string</li>
<li><code>Number</code> - Stores numeric values, including floating points.</li>
<li><code>Boolean</code> - Either true or false. (To avoid confusion, Deployd will consider null or undefined to be false)</li>
<li><code>Object</code> - Stores any JSON object. Useful for storing arbitrary data on an object without needing to validate schema.</li>
<li><code>Array</code> - Stores an array of any type.</li>
</ul></div><div class="section"><a name="s-The Data Editor-1996"></a><h3>The Data Editor <a class="anchor-link" href="collections-include=all.html#s-The%20Data%20Editor-1996">#</a></h3>

<p>Once you create a Collection from the dashboard, you can add and edit its data using the data editor. The data editor is designed to edit all sorts of data, including objects and arrays.</p><div class="section"><a name="s-Basic Use-1346"></a><h4>Basic Use <a class="anchor-link" href="collections-include=all.html#s-Basic%20Use-1346">#</a></h4>

<p>Double-click in a cell to start editing. Press Enter to save your changes, or Escape to cancel and undo your changes.</p>

<p>While editing a string property, click the "edit" icon next to the field to open up a multiline editor.</p>

<p>Click the trash can icon in any row to delete it.</p>

<p>Edit the bottom-most row to create a new object. Press Enter when editing a property to save the row, or click the checkmark in the margin.</p></div><div class="section"><a name="s-Useful Shortcuts-1346"></a><h4>Useful Shortcuts <a class="anchor-link" href="collections-include=all.html#s-Useful%20Shortcuts-1346">#</a></h4>

<ul>
<li>Use the arrow keys to move your selection without using the mouse.</li>
<li>Press "Enter" when a cell is selected to start editing.</li>
<li>Start typing when a cell is selected to overwrite its existing value. </li>
<li>If you accidentally save a change, press Ctrl/Cmd-Z to reverse it.</li>
<li>Press Ctrl-Delete to remove a row. Press Ctrl/Cmd-Z to add it back. (heads up: it will have a different <code>id</code>)</li>
<li>Press Ctrl-Enter to open up the multiline editor for a string property; this lets you write long text values.</li>
<li>Press Ctrl-Enter while in the multiline editor to save it (pressing Enter will just create a new line)</li>
<li>Press Tab to save the current property and edit the next one.</li>
</ul></div></div></div>  

      
        

  <div class="section"><a name="s-Accessing Collections with dpd.js"></a><h2>Accessing Collections with dpd.js <a class="anchor-link" href="collections-include=all.html#s-Accessing%20Collections%20with%20dpd.js">#</a></h2>

<p><code>dpd.js</code> is an auto-generated library that updates as you update the resources in your Deployd API. If you are writing your front-end in the <code>public</code> directory, include a script tag tag in your HTML:</p>

<pre><code>&lt;script src="/dpd.js" type="text/javascript"&gt;&lt;/script&gt;
</code></pre>

<p><em>Note: The dpd.js file will not appear in the <code>public</code> directory because it is generated at runtime.</em></p><div class="section"><a name="s-Example Usage-3182"></a><h3>Example Usage <a class="anchor-link" href="collections-include=all.html#s-Example%20Usage-3182">#</a></h3>

<pre><code>dpd.todos.get(function(todos, error) {
  if (error) {
    alert(error.message);
  } else {
    for (var i = 0; i &lt; todos.length; i++) {
      renderTodo(todos[i]);
    };
  }
});
</code></pre>

<p>Dpd.js functions are <em>asynchronous</em>: they do not return a value, but execute a callback function when the AJAX operation is complete.</p>

<pre><code>// Does not work
var result = dpd.todos.get();
</code></pre>

<!--...-->

<pre><code>// Works as expected
dpd.todos.get(function(result, error) {
  // Work with result
});
</code></pre>

<p>For details on using dpd.js, see the <a href="collections/reference/dpd-js.md.html">dpd.js reference</a></p>

<p>Also see <a href="collections/examples/a-simple-todo-app.md.html">A Simple Todo App</a> for a working example.</p></div><div class="section"><a name="s-Using dpd.js on a different origin-3182"></a><h3>Using dpd.js on a different origin <a class="anchor-link" href="collections-include=all.html#s-Using%20dpd.js%20on%20a%20different%20origin-3182">#</a></h3>

<p>You can use the dpd.js library outside of the <code>public</code> folder by using an absolute URL to the file.</p>

<p>This will not work on browsers that do not support Cross-Origin Resource Sharing (namely Internet Explorer 7 and below).</p></div><div class="section"><a name="s-Accessing Collections without Dpd.js-3182"></a><h3>Accessing Collections without Dpd.js <a class="anchor-link" href="collections-include=all.html#s-Accessing%20Collections%20without%20Dpd.js-3182">#</a></h3>

<p>The dpd.js library is not required; it is only a utility library for accessing Deployd's HTTP API with AJAX. For details on the HTTP API, see the <a href="collections/reference/http.md.html">HTTP API Refernence</a>.</p>

<p>Some front-end libraries include support for HTTP or REST APIs; for examples of how to use these instead of dpd.js, see <a href="collections/examples/a-simple-todo-app-with-backbone.md.html">A Simple Todo App with Backbone</a> and <a href="collections/examples/a-simple-todo-app-with-angular.md.html">A Simple Todo App with AngularJS</a></p></div></div>  

      
        

  <div class="section"><a name="s-Adding Custom Business Logic with Events"></a><h2>Adding Custom Business Logic with Events <a class="anchor-link" href="collections-include=all.html#s-Adding%20Custom%20Business%20Logic%20with%20Events">#</a></h2>

<p>Events allow you to add custom business logic to your Collection. By writing Events, you can add validation, relationships, and security to your app. Events are written in JavaScript (specifically, the ECMAScript 5 standard) and have access to the <a href="collections/reference/event-api.md.html">Collection Events API</a>.</p>

<p>The following events are available for scripting:</p><div class="section"><a name="s-On Get-3789"></a><h3>On Get <a class="anchor-link" href="collections-include=all.html#s-On%20Get-3789">#</a></h3>

<p>Called whenever an object is loaded from the server. Commonly used to hide properties, restrict access to private objects, and calculate dynamic values.</p>

<pre><code>// Example On Get: Hide Secret Properties
if (!me || me.id !== this.creatorId) {
  hide('secret');
}
</code></pre>

<!--seperate-->

<pre><code>// Example On Get: Load A Post's Comments
if (query.loadComments) {
  dpd.comments.get({postId: this.id}, function(comments) {
    this.comments = comments;
  });  
}
</code></pre>

<p><em>Note: When a list of objects is loaded, <code>On Get</code> will run once for each object in the list. Calling <code>cancel()</code> in this case will remove the object from the list, rather than cancelling the entire request.</em></p></div><div class="section"><a name="s-On Validate -3789"></a><h3>On Validate  <a class="anchor-link" href="collections-include=all.html#s-On%20Validate%20-3789">#</a></h3>

<p>Called whenever an object's values change, including when it is first created. Commonly used to validate property values and calculate certain dynamic values (i.e. last modified time). </p>

<pre><code>// Example On Validate: Enforce a max length
if (this.body.length &gt; 100) {
  error('body', "Cannot be more than 100 characters");
}
</code></pre>

<!--seperate-->

<pre><code>// Example On Validate: Normalize an @handle
if (this.handle.indexOf('@') !== 0) {
  this.handle = '@' + this.handle;
}
</code></pre>

<p><em>Note: <code>On Post</code> or <code>On Put</code> will execute after <code>On Validate</code>, unless <code>cancel()</code> or <code>error()</code> is called</em></p></div><div class="section"><a name="s-On Post-3789"></a><h3>On Post <a class="anchor-link" href="collections-include=all.html#s-On%20Post-3789">#</a></h3>

<p>Called when an object is created. Commonly used to prevent unauthorized creation and save data relevant to the creation of an object, such as its creator.</p>

<pre><code>// Example On Post: Save the date created
this.createdDate = new Date().getTime();
</code></pre>

<!--seperate-->

<pre><code>// Example On Post: Prevent unauthorized users from posting
if (!me) {
  cancel("You must be logged in", 401);
}
</code></pre></div><div class="section"><a name="s-On Put-3789"></a><h3>On Put <a class="anchor-link" href="collections-include=all.html#s-On%20Put-3789">#</a></h3>

<p>Called when an object is updated. Commonly used to restrict editing access to certain roles, or to protect certain properties from editing. It is strongly recommended that you <code>protect()</code> any properties that should not be modifiable by users after an object is created.</p>

<pre><code>// Example On Put: Protect readonly/automatic properties
protect('createdDate');
protect('creatorId');
</code></pre></div><div class="section"><a name="s-On Delete -3789"></a><h3>On Delete  <a class="anchor-link" href="collections-include=all.html#s-On%20Delete%20-3789">#</a></h3>

<p>Called when an object is deleted. Commonly used to prevent unauthorized deletion.</p>

<pre><code>// Example On Delete: Prevent non-admins from deleting
if (!me || me.role !== 'admin') {
  cancel("You must be an admin to delete this", 401);
}
</code></pre></div></div>  

      
        

  <div class="section"><a name="s-Accessing Collections - Building a Custom Client"></a><h2>Accessing Collections - Building a Custom Client <a class="anchor-link" href="collections-include=all.html#s-Accessing%20Collections%20-%20Building%20a%20Custom%20Client">#</a></h2>

<p>In this guide, we will build an HTTP client from scratch to perform CRUD as well as listen for events from a Collection.</p><div class="section"><a name="s-REST-4453"></a><h3>REST <a class="anchor-link" href="collections-include=all.html#s-REST-4453">#</a></h3>

<p>Most REST clients should work with Deployd Collections right away, though Deployd does not strictly follow REST. For example, Backbone.js and AngularJS's HTTP utilities work with Deployd without modification.</p></div><div class="section"><a name="s-WebSockets-4453"></a><h3>WebSockets <a class="anchor-link" href="collections-include=all.html#s-WebSockets-4453">#</a></h3>

<p>To fully implement the Collection API, a client must be compatible with WebSockets and Socket.IO specifically. Clients are responsible for sending heartbeat information as well as reconnecting in the case of unexpected disconnects.</p></div><div class="section"><a name="s-Building a Node.js Client-4453"></a><h3>Building a Node.js Client <a class="anchor-link" href="collections-include=all.html#s-Building%20a%20Node.js%20Client-4453">#</a></h3>

<p>The following is implemented in <a href="http://nodejs.org/">Node.js</a>, but the basic idea can be applied to any language or platform.</p><div class="section"><a name="s-Basics-2271"></a><h4>Basics <a class="anchor-link" href="collections-include=all.html#s-Basics-2271">#</a></h4>

<p>All we need to create a collection client is a constructor and a single method for making requests.</p>

<pre><code>var request = require('request');

function Collection(url) {
  this.url = url
}

Collection.prototype.request = function (options, fn) {
  var url = this.url;
  options.url = url + (options.url || '');  
  request(options, function (err, res, body) {
    if(res.statusCode &gt;= 400) {
      err = body || {message: 'an unknown error occurred'};
      return fn(err);
    }

    fn(null, body);
  });
}
</code></pre>

<p>Now we can construct new collections by passing the URL as the only argument to our constructor.</p>

<pre><code>var c = new Collection('http://foo.deploydapp.com/todos');

c.request({url: '?done=false'}, function(err, todos) {
  console.log(todos); // [...]
});
</code></pre>

<p>We can add an object to our collection by passing an object as the json body and setting the <code>method</code> to "POST".</p>

<pre><code>var todo = {
  title: 'wash the car'
};

c.request({json: todo, method: 'POST'}, function(err, todo) {
  console.log(todo); // {id: '...', ...}
});
</code></pre>

<p>To update an object we just need to set the <code>method</code> to "PUT".</p>

<pre><code>var todo = {
  id: '06a5254f11ff7853',
  done: true
};

c.request({json: todo, method: 'PUT'}, function(err, todo) {
  console.log(todo); // {id: '...', ...}
});
</code></pre>

<p>Deleting an object requires an ID and the method must be set to "DELETE".</p>

<pre><code>var id = '06a5254f11ff7853';

c.request({url: '/' + id, method: 'DELETE'}, function(err, todo) {
  console.log(err); // null - if no error occurred
});
</code></pre></div><div class="section"><a name="s-Listening to Events"></a><h3>Listening to Events <a class="anchor-link" href="collections-include=all.html#s-Listening%20to%20Events">#</a></h3>

<p>The simplest way to listen events is to use a Socket.IO client. You can find a list of clients <a href="https://github.com/LearnBoost/socket.io/wiki">here</a>.</p>

<p>Using the node.js Socket.IO client, we can create a socket by connecting to our deployed app. Then calling the socket's <code>on()</code> method to listen to a custom event emitted by a collection.</p>

<pre><code>var io = require('socket.io-client');
var socket = io.connect('http://foo.deploydapp.com');

socket.on('my event', function (data) {
  console.log(data); // emit()ed from the server
});
</code></pre></div></div></div>  

      
        

  <div class="section"><a name="s-A Simple Todo App"></a><h2>A Simple Todo App <a class="anchor-link" href="collections-include=all.html#s-A%20Simple%20Todo%20App">#</a></h2>

<p><img src="../examples/images/todo-app.png" alt="Todo app" title="" /></p>

<p>This app demonstrates how to access a Collection's API using dpd.js.</p>

<p><a href="https://github.com/downloads/deployd/examples/todo-app.zip" class="btn btn-primary">Download</a> <a href="https://github.com/deployd/examples/tree/master/collection/todo-app" class="btn">View Source</a></p><div class="section"><a name="s-Useful files-1474"></a><h3>Useful files <a class="anchor-link" href="collections-include=all.html#s-Useful%20files-1474">#</a></h3>

<ul>
<li><a href="https://github.com/deployd/examples/blob/master/collection/todo-app/public/js/todo.js">todo.js</a></li>
</ul></div></div><div class="section"><a name="s-A Simple Todo App with AngularJS"></a><h2>A Simple Todo App with AngularJS <a class="anchor-link" href="collections-include=all.html#s-A%20Simple%20Todo%20App%20with%20AngularJS">#</a></h2>

<p><img src="../examples/images/todo-app.png" alt="Todo app" title="" /></p>

<p>This app demonstrates how to access a Collection's API using the <a href="http://angularjs.org/">AngularJS</a> framework.</p>

<p><a href="https://github.com/downloads/deployd/examples/todo-app-angular.zip" class="btn btn-primary">Download</a> <a href="https://github.com/deployd/examples/tree/master/collection/todo-app-angular" class="btn">View Source</a></p><div class="section"><a name="s-Useful files-2853"></a><h3>Useful files <a class="anchor-link" href="collections-include=all.html#s-Useful%20files-2853">#</a></h3>

<ul>
<li><a href="https://github.com/deployd/examples/blob/master/collection/todo-app-angular/public/index.html">index.html</a></li>
<li><a href="https://github.com/deployd/examples/blob/master/collection/todo-app-angular/public/js/todo.js">todo.js</a></li>
</ul></div></div><div class="section"><a name="s-A Simple Todo App with Backbone.js"></a><h2>A Simple Todo App with Backbone.js <a class="anchor-link" href="collections-include=all.html#s-A%20Simple%20Todo%20App%20with%20Backbone.js">#</a></h2>

<p><img src="../examples/images/todo-app.png" alt="Todo app" title="" /></p>

<p>This app demonstrates how to access a Collection's API using <a href="http://backbonejs.org/">Backbone.js</a>.</p>

<p><a href="https://github.com/downloads/deployd/examples/todo-app-backbone.zip" class="btn btn-primary">Download</a> <a href="https://github.com/deployd/examples/tree/master/collection/todo-app-backbone" class="btn">View Source</a></p><div class="section"><a name="s-Useful files-3038"></a><h3>Useful files <a class="anchor-link" href="collections-include=all.html#s-Useful%20files-3038">#</a></h3>

<ul>
<li><a href="https://github.com/deployd/examples/blob/master/collection/todo-app-backbone/public/index.html">index.html</a></li>
<li><a href="https://github.com/deployd/examples/blob/master/collection/todo-app-backbone/public/js/todo.js">todo.js</a></li>
</ul></div></div><div class="section"><a name="s-Chatroom"></a><h2>Chatroom <a class="anchor-link" href="collections-include=all.html#s-Chatroom">#</a></h2>

<p><img src="../examples/images/chat-room.png" alt="Todo app" title="" /></p>

<p>This app demonstrates how to send messages to the client using Sockets when data is updated on the server.</p>

<p><a href="https://github.com/downloads/deployd/examples/chatroom.zip" class="btn btn-primary">Download</a> <a href="https://github.com/deployd/examples/tree/master/collection/chatroom" class="btn">View Source</a></p><div class="section"><a name="s-Useful files-829"></a><h3>Useful files <a class="anchor-link" href="collections-include=all.html#s-Useful%20files-829">#</a></h3>

<ul>
<li><a href="https://github.com/deployd/examples/blob/master/collection/chatroom/public/js/chatroom.js">chatroom.js</a></li>
<li><a href="https://github.com/deployd/examples/blob/master/collection/chatroom/resources/messages/validate.js">messages/validate.js</a> (On Validate <code>/messages</code>)</li>
<li><a href="https://github.com/deployd/examples/blob/master/collection/chatroom/resources/messages/post.js">messages/post.js</a> (On POST <code>/messages</code>)</li>
</ul></div></div>  

      
        

    

      
        

  <div class="section"><a name="s-Relationships Between Collections with Events"></a><h2>Relationships Between Collections with Events <a class="anchor-link" href="collections-include=all.html#s-Relationships%20Between%20Collections%20with%20Events">#</a></h2>

<p>Designing the relationships between the collections in your application is crucial to a useful API. In typical databases, there are very specific ways to implement the relation of objects in one table (or collection) and another. Deployd lets you relate your data however your application requires and is flexible enough to allow you to easily change the way objects are related.</p><div class="section"><a name="s-Types of Relationships-4447"></a><h3>Types of Relationships <a class="anchor-link" href="collections-include=all.html#s-Types%20of%20Relationships-4447">#</a></h3>

<p>When designing the collections in your application keep in mind the following strategies for relating data. There isn't a single best way to create relationships, so you will have to take into account how data will change in your collections. </p><div class="section"><a name="s-Embedding Data-2191"></a><h4>Embedding Data <a class="anchor-link" href="collections-include=all.html#s-Embedding%20Data-2191">#</a></h4>

<p>Deployd allows your collection to store complex structures such as nested objects or arrays. This is useful if you want to embed data inside your collection's objects. Keep in mind this is only recommended when the embedded data is not likely to change. For example, a <code>blog-posts</code> collection could have an <code>author</code> property with a type set to <code>Object</code>.</p>

<pre><code>{
  "title": "Foo Bar Bat Baz?",
  "author": {
    "name": "Joe Bob",
    "id": "5ef0f7d515764998"
  }
}
</code></pre>

<p>This style of relationship allows users of the collection to display the name of the author without running any other queries. The downside is an update event is required to keep the author name in sync if it ever changes. If your data changes often, this may not be the best approach.</p></div><div class="section"><a name="s-Contains Many or One-to-Many-2191"></a><h4>Contains Many or One-to-Many <a class="anchor-link" href="collections-include=all.html#s-Contains%20Many%20or%20One-to-Many-2191">#</a></h4>

<p>Similarly to storing nested objects in your collection, you can also store arrays of arbitrary JSON. This is useful when you want to setup a <strong>contains</strong> relationship. For example, in a gradebook application, your <code>classes</code> collection objects could <strong>contain</strong> <code>students</code>.</p>

<pre><code>{
  "title": "Language Arts",
  "students": ["5ef0f7d515764998", "5ef0f7d515764531", ...] 
}
</code></pre>

<p>By storing an array of student ids you can easily query classes by student.</p>

<pre><code>dpd.classes.get({students: '5ef0f7d515764998'}, function(classes) {
  console.log(classes); // [...] - all the classes the student is in.
});
</code></pre></div><div class="section"><a name="s-Many-to-Many-2191"></a><h4>Many-to-Many <a class="anchor-link" href="collections-include=all.html#s-Many-to-Many-2191">#</a></h4>

<p>There are several ways to handle <strong>many-to-many</strong> relationships. The most common way is to include an <code>Array</code> property that stores the <code>id</code>s of the related objects on both collections.</p>

<p>Continuing with the gradebook example, a student may have many classes, and a class may have many students. The <code>classes</code> collection would have a <code>students</code> <code>Array</code> property containing the student ids and the <code>students</code> collection would have a classes <code>Array</code> property containing class ids.</p>

<p>This lets you query each collection to get the students in a class or the classes a student is taking by providing the id of the class or student.</p>

<pre><code>dpd.students.get({id: {$in: class.students}}, function(students) {
  console.log(students);
}); 

// or

dpd.classes.get({id: {$in: student.classes}}, function(classes) {
  console.log(classes);
});
</code></pre>

<p>If you wanted to include the full objects when querying the API you could implement a simple <code>GET</code> event.</p>

<pre><code>// on GET /students

if(query.include === 'classes') {
  dpd.classes.get({id: {$in: student.classes}}, function(classes) {
    this.classes = classes;
  });
}
</code></pre>

<p>Then if you added the <code>include</code> param when querying from the browser, a student would come back with all of its classes.</p>

<pre><code>dpd.students.get({id: '2ef0f7d515764991', include: 'classes'}, fn);
</code></pre>

<p>would output</p>

<pre><code>{
  "id": "2ef0f7d515764991",
  "name": "Joe Bob",
  "classes": [{
    "id": "...",
    "title": "Language Arts"
  }, ...]
}
</code></pre></div><div class="section"><a name="s-Parent-Child-2191"></a><h4>Parent-Child <a class="anchor-link" href="collections-include=all.html#s-Parent-Child-2191">#</a></h4>

<p>Some collections contain objects related to other objects in the same collection. A simple example of this is threaded comments. Where a comment can be in reply to another comment, creating a tree-like structure when rendered.</p>

<p>To accomplish this, all you need is a <code>parent</code> property containing the <code>id</code> of a parent object if one exists. Since Deployd supports recursive queries in a collection's <code>GET</code> event, the following works as you would expect.</p>

<pre><code>// on GET /comments
var comment = this;

dpd.comments.get({parent: comment.id}, function(comments) {
  if(comments &amp;&amp; comments.length) comment.children = comments;
});
</code></pre>

<p>Running the following query from the browser would result in a nested structure of all possible comments:</p>

<pre><code>// from the browser
dpd.comments.get({id: '2ef0f7d515764991'}, console.log);
</code></pre>

<p>would output</p>

<pre><code>{
  "id": "2ef0f7d515764991"
  "text": "Hello, World!",
  "children": [
    {
      "id": "tef0f7d515761234",
      "text": "Foo bar...",
      "children": [
        {
          "id": "ff00f7d515764642",
          "text": "I agree!"
        },
        {
          "id": "2200f7d51576123",
          "text": "I do not agree!"
        },
      ]
    }
  ]
}
</code></pre>

<p>If you expect that a query could become an infinite loop (or if it already is an infinite loop; a good sign of this is requests that time out before returning a result), put a <code>$limitRecursion</code> property on your query with the maximum number of levels to iterate:</p>

<pre><code>// on GET /comments
var comment = this;

dpd.comments.get({parent: comment.id, $limitRecursion: 10}, function(comments) {
  if(comments &amp;&amp; comments.length) comments.children = comments;
});
</code></pre></div></div></div>  

      
        

  <div class="section"><a name="s-Notifying the Client of Changes with Messages"></a><h2>Notifying the Client of Changes with Messages <a class="anchor-link" href="collections-include=all.html#s-Notifying%20the%20Client%20of%20Changes%20with%20Messages">#</a></h2>

<p>Keeping all of the clients of your API up-to-date with your collection's latest data is simple with collection events. For example, in a <code>PUT</code> event, you can notify all connected clients of the changes to the object being updated by calling the <a href="collections/reference/event-api.md.html#s-emit">emit()</a> function to send all connected users a message.</p>

<p>The <code>emit()</code> function takes an event argument and an arbitrary data object to send to all of the connected clients  (eg. <code>emit('my message', {foo: 'bar'})</code>). Dpd.js clients can listen for these events using the <code>on()</code> method (eg. <code>dpd.todos.on('my message', fn)</code>).</p><div class="section"><a name="s-Example-4249"></a><h3>Example <a class="anchor-link" href="collections-include=all.html#s-Example-4249">#</a></h3>

<p>Let's say you want to make a chatroom app and you have a Collection called <code>/messages</code>. </p>

<p>In the <code>On POST</code> event of <code>/messages</code>, you would add the following line:</p>

<pre><code>emit('messages:create', this);
</code></pre>

<p>This sends a message called <code>messages:create</code> (This could be anything) with the current object (<code>this</code>) as an argument. The <code>messages:</code> prefix namespaces the event to the collection.</p>

<p>On the client, you would listen for that event using <code>dpd.on()</code> and respond by updating the DOM:</p>

<pre><code>dpd.messages.on('create', function(message) {
  renderMessage(message);
});
</code></pre>

<p>The <code>message</code> argument is the value you passed on the server (<code>this</code>).</p>

<p>See the <a href="collections/examples/chatroom.md.html">Chatroom Example</a> for a working version of this code.</p></div><div class="section"><a name="s-Browser and Server Support-4249"></a><h3>Browser and Server Support <a class="anchor-link" href="collections-include=all.html#s-Browser%20and%20Server%20Support-4249">#</a></h3>

<p>The realtime messaging features of Deployd are built on <a href="http://socket.io/">Socket.IO</a> and work on almost every major browser:</p>

<ul>
<li>Internet Explorer 5.5+</li>
<li>Safari 3+</li>
<li>Google Chrome 4+</li>
<li>Firefox 3+</li>
<li>Opera 10.61+</li>
<li>iOS Safari</li>
<li>Android WebKit</li>
<li>WebOS WebKit</li>
</ul>

<p>(taken from <a href="http://socket.io/#browser-support">Socket.IO's site</a>)</p></div><div class="section"><a name="s-Further Reading-4249"></a><h3>Further Reading <a class="anchor-link" href="collections-include=all.html#s-Further%20Reading-4249">#</a></h3>

<ul>
<li><a href="collections/notifying-clients.md.html">Event API</a></li>
<li><a href="collections/reference/dpd-js.md.html">dpd.js Reference</a></li>
<li><a href="collections/reference/http.md.html">HTTP API Reference</a></li>
</ul></div></div>  

      
        

  <div class="section"><a name="s-Event API"></a><h2>Event API <a class="anchor-link" href="collections-include=all.html#s-Event%20API">#</a></h2><div class="section api"><a name="s-this-764"></a><h3>this <!--api--> <a class="anchor-link" href="collections-include=all.html#s-this-764">#</a></h3>

<p>The current object is represented as <code>this</code>. You can always read its properties. Modifying its properties in an <code>On Get</code> request will change the result that the client receives, while modifying its properties in an <code>On Post</code>, <code>On Put</code>, or <code>On Validate</code> will change the value in the database.</p>

<pre><code>// Example: On Validate
// If a property is too long, truncate it
if (this.message.length &gt; 140) {
  this.message = this.message.substring(0, 137) + '...';
}
</code></pre>

<p><em>Note</em>: In some cases, the meaning of <code>this</code> will change to something less useful inside of a function. If you are using functions such as <code>Array.forEach()</code>, you may need to bind another variable to <code>this</code>:</p>

<pre><code>// Won't work - sum remains at 0
this.sum = 0;
this.targets.forEach(function(t) {
  this.sum += t.points;
});
</code></pre>

<!--seperate-->

<pre><code>//Works as expected
var self = this;

this.sum = 0;
this.targets.forEach(function(t) {
  self.sum += t.points;
});
</code></pre></div><div class="section api"><a name="s-me-764"></a><h3>me <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-me-764">#</a></h3>

<p>The currently logged in User from a User Collection. <code>undefined</code> if no user is logged in.</p>

<pre><code>// Example: On Post
// Save the creator's information
if (me) {
    this.creatorId = me.id;
    this.creatorName = me.name;
}
</code></pre></div><div class="section api"><a name="s-isMe()-764"></a><h3>isMe() <!-- api -->  <a class="anchor-link" href="collections-include=all.html#s-isMe()-764">#</a></h3>

<pre><code>isMe(id)
</code></pre>

<p>Checks whether the current user matches the provided <code>id</code>.</p>

<pre><code>// Example: On Get /users
// Hide properties unless this is the current user
if (!isMe(this.id)) {
    hide('privateVariable');
}
</code></pre>

<!-- seperate -->

<pre><code>// Example: On Put 
// Make sure that only the creator can edit a post
cancelUnless(isMe(this.id), "You are not authorized to edit that post", 401);
</code></pre></div><div class="section api"><a name="s-query-764"></a><h3>query <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-query-764">#</a></h3>

<p>The query string object. On a specific query (such as <code>/posts/a59551a90be9abd8</code>), this includes an <code>id</code> property.</p>

<pre><code>// Example: On Get
// Don't show the body of a post in a general query
if (!query.id) {
  hide(this.body);
}
</code></pre></div><div class="section api"><a name="s-cancel()-764"></a><h3>cancel() <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-cancel()-764">#</a></h3>

<pre><code>cancel(message, [statusCode])
</code></pre>

<p>Stops the current request with the provided error message and HTTP status code. Status code defaults to <code>400</code>. Commonly used for security and authorization. </p>

<p>It is strongly recommended that you <code>cancel()</code> any events that are not accessible to your front-end, because your API is open to anyone.</p>

<pre><code>// Example: On Post
// Don't allow non-admins to create items
if (!me.admin) {
  cancel("You are not authorized to do that", 401);
}
</code></pre>

<p><em>Note: In a GET event where multiple values are queried (such as on <code>/posts</code>), the <code>cancel()</code> function will remove the current item from the results without an error message.</em></p></div><div class="section api"><a name="s-cancelIf(), cancelUnless()-764"></a><h3>cancelIf(), cancelUnless() <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-cancelIf(),%20cancelUnless()-764">#</a></h3>

<pre><code>cancelIf(condition, message, [statusCode])
cancelUnless(condition, message, [statusCode])
</code></pre>

<p>Calls <code>cancel(message, statusCode)</code> if the provided condition is truthy (for <code>cancelIf()</code>) or falsy (for <code>cancelUnless()</code>).</p>

<pre><code>Example: On Post
// Prevent banned users from posting
cancelUnless(me, "You are not logged in", 401);
cancelIf(me.isBanned, "You are banned", 401);
</code></pre></div><div class="section api"><a name="s-error()-764"></a><h3>error() <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-error()-764">#</a></h3>

<pre><code>error(key, message)
</code></pre>

<p>Adds an error message to an <code>errors</code> object in the response. Cancels the request, but continues running the event so it can collect multiple errors to display to the user. Commonly used for validation.</p>

<pre><code>// Example: On Validate
// Don't allow certain words
// Returns response {"errors": {"name": "Contains forbidden words"}}
if (!this.name.match(/(foo|bar)/)) {
  error('name', "Contains forbidden words");
}
</code></pre></div><div class="section api"><a name="s-errorIf(), errorUnless()-764"></a><h3>errorIf(), errorUnless() <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-errorIf(),%20errorUnless()-764">#</a></h3>

<pre><code>errorIf(condition, key, message)
errorUnless(condition, key, message)
</code></pre>

<p>Calls <code>error(key, message)</code> if the provided condition is truthy (for <code>errorIf()</code>) or falsy (for <code>errorUnless()</code>).</p>

<pre><code>// Example: On Validate
// Require message to be a certain length
errorUnless(this.message &amp;&amp; this.message.length &gt; 2, 'message', "Must be at least 2 characters");
</code></pre></div><div class="section api"><a name="s-hide()-764"></a><h3>hide() <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-hide()-764">#</a></h3>

<pre><code>hide(property)
</code></pre>

<p>Hides a property from the response.</p>

<pre><code>// Example: On Get
// Don't show private information
if (!me || me.id !== this.creatorId) {
  hide('secret');
}
</code></pre></div><div class="section api"><a name="s-protect()-764"></a><h3>protect() <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-protect()-764">#</a></h3>

<pre><code>protect(property)
</code></pre>

<p>Prevents a property from being updated. It is strongly recommended you <code>protect()</code> any properties that should not be modified after an object is created. </p>

<pre><code>// Example: On Put
// Protect a property
protect('createdDate');
</code></pre>

<!-- seperate -->

<pre><code>// Example: On Put
// Only the creator can change the title
if (!(me &amp;&amp; me.id === this.creatorId)) {
  protect('title');
}
</code></pre></div><div class="section api"><a name="s-changed()-764"></a><h3>changed() <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-changed()-764">#</a></h3>

<pre><code>changed(property)
</code></pre>

<p>Returns whether a property has been updated.</p>

<pre><code>// Example: On Put
// Validate the title when it changes
if(changed('title') &amp;&amp; this.title.length &lt; 5) {
  error('title', 'must be over 5 characters');
}
</code></pre></div><div class="section api"><a name="s-previous-764"></a><h3>previous <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-previous-764">#</a></h3>

<p>An <code>Object</code> containing the previous values of the item to be updated.</p>

<pre><code>// Example: On Put
if(this.votes &lt; previous.votes) {
  emit('votes have decreased');
}
</code></pre></div><div class="section api"><a name="s-emit()-764"></a><h3>emit() <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-emit()-764">#</a></h3>

<pre><code>emit([userCollection, query], message, [data])
</code></pre>

<p>Emits a realtime message to the client. </p>

<pre><code>// Example: On Post
// Alert clients that a new post has been created
emit('postCreated', this);
</code></pre>

<p>In the front end:</p>

<pre><code>// Listen for new posts
dpd.on('postCreated', function(post) {
    //do something...
});
</code></pre>

<p>You can use <code>userCollection</code> and <code>query</code> parameters to limit the message broadcast to specific users.</p>

<pre><code>// Example: On Put
// Alert the owner that their post has been modified
if (me.id !== this.creatorId) {
  emit(dpd.users, {id: this.creatorId}, 'postModified', this); 
} 
</code></pre>

<p>See <a href="collections/notifying-clients.md.html">Notifying Clients of Changes with Sockets</a> for an overview on realtime functionality.</p></div><div class="section reference"><a name="s-dpd-764"></a><h3>dpd <!-- ref --> <a class="anchor-link" href="collections-include=all.html#s-dpd-764">#</a></h3>

<p>The entire <a href="collections/reference/dpd-js.md.html">dpd.js</a> library, except for the realtime functions, is available in events. It will also properly bind <code>this</code> in callbacks.</p>

<pre><code>// Example: On Get
// If specific query, get comments
dpd.comments.get({postId: this.id}, function(results) {
  this.comments = results;
});
</code></pre>

<!--seperate-->

<pre><code>// Example: On Delete
// Log item elsewhere
dpd.archived.post(this);
</code></pre>

<p>Dpd.js will prevent recursive requests if you set the <a href="collections/reference/querying-collections.md.html#s-$limitRecursion">$limitRecursion</a> property. This works by returning <code>null</code> from a <code>dpd</code> function call that has already been called several times further up in the stack.</p>

<pre><code>// Example: On Get /recursive
// Call self
dpd.recursive.get({$limitRecursion: 1}, function(results) {
    if (results) this.recursive = results;
});
</code></pre>

<!--seperate-->

<pre><code>// GET /recursive
{
    "id": "a59551a90be9abd8",
    "recursive": [
        {
            "id": "a59551a90be9abd8"    
        }
    ]
}
</code></pre></div><div class="section api"><a name="s-internal-764"></a><h3>internal <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-internal-764">#</a></h3>

<p>Equal to true if this request has been sent by another script.</p>

<pre><code>// Example: On GET /posts
// Posts with a parent are invisible, but are counted by their parent
if (this.parentId &amp;&amp; !internal) cancel();

dpd.posts.get({parentId: this.id}, function(posts) {
    this.childPosts = posts.length;
});
</code></pre></div><div class="section api"><a name="s-isRoot-764"></a><h3>isRoot <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-isRoot-764">#</a></h3>

<p>Equal to true if this request has been authenticated as <a href="collections/reference/http.md.html#s-Root-Requests">root</a> (has the <code>dpd-ssh-key</code> header with the appropriate key; such as from the dashboard)</p>

<pre><code>// Example: On PUT /users
// Protect reputation property - should only be calculated by a custom script.

if (!isRoot) protect('reputation');
</code></pre></div><div class="section api"><a name="s-console.log()-764"></a><h3>console.log() <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-console.log()-764">#</a></h3>

<pre><code>console.log([arguments]...)
</code></pre>

<p>Logs the values provided to the command line. Useful for debugging.</p></div></div><div class="section"><a name="s-Accessing Collections Over HTTP"></a><h2>Accessing Collections Over HTTP <a class="anchor-link" href="collections-include=all.html#s-Accessing%20Collections%20Over%20HTTP">#</a></h2>

<p>Deployd exposes an HTTP API to your Collections which can be used by any platform or library that supports HTTP or AJAX. Though it does not strictly adhere to REST, it should also work with most libraries designed for REST.</p><div class="section"><a name="s-Collection API-2891"></a><h3>Collection API <a class="anchor-link" href="collections-include=all.html#s-Collection%20API-2891">#</a></h3>

<p>The examples below use a Collection called <code>/todos</code> with the following schema:</p>

<ul>
<li><code>id</code></li>
<li>string <code>title</code></li>
<li>string <code>category</code></li>
</ul>

<p>Your Collection is available at the URL you specified. If you are using the default development hostname of <code>localhost:2403</code>, for example, the <code>/todos</code> collection will be available at <code>http://localhost:2403/todos</code>.</p><div class="section reference"><a name="s-Requests-1286"></a><h4>Requests <!-- ref --> <a class="anchor-link" href="collections-include=all.html#s-Requests-1286">#</a></h4>

<p>A request to the Deployd API should include the <code>Content-Type</code> header. The following content types are supported:</p>

<ul>
<li><code>application/json</code> (recommended)</li>
<li><code>application/x-www-form-urlencoded</code> (All values will be parsed as strings)</li>
</ul>

<p>The <code>Content-Type</code> header is not necessary for <code>GET</code> or <code>DELETE</code> requests which have no body.</p></div><div class="section reference"><a name="s-Responses-1286"></a><h4>Responses <!-- ref --> <a class="anchor-link" href="collections-include=all.html#s-Responses-1286">#</a></h4>

<p>Deployd will send standard HTTP status codes depending on the results on an operation. If the code is 200 (OK), the request was successful and the result is available in the body as JSON.</p>

<p>If the code is 204 (No Content), the request was successful, but there is no result.</p>

<p>If the code is 400 or greater, it will return the error message formatted as a JSON object:</p>

<ul>
<li><code>status</code> (number): The HTTP status code of the request. Common codes include:
<ul><li>400 - Bad Request: The request contained invalid data and could not be completed</li>
<li>401 - Unauthorized: The current session is not authorized to perform that action</li>
<li>500 - Internal Server Error: Something went wrong on the server</li></ul></li>
<li><code>message</code> (string): A message describing the error. Not always present.</li>
<li><code>errors</code> (object): A hash of error messages corresponding to the properties of the object that was sent - usually indicates validation errors. Not always present.</li>
</ul>

<p>Examples of errors:</p>

<pre><code>{
  "status": 401,
  "message": "You are not allowed to access that collection!"
}
</code></pre>

<!--...-->

<pre><code>{
  "status": 400,
  "errors": {
      "title": "Title must be less than 100 characters",
      "category": "Not a valid category"
  }
}
</code></pre></div><div class="section reference"><a name="s-Listing Data-1286"></a><h4>Listing Data <!-- ref --> <a class="anchor-link" href="collections-include=all.html#s-Listing%20Data-1286">#</a></h4>

<p>To retreive an array of objects in the collection, send a <code>GET</code> request to your collection's path:</p>

<pre><code>GET /todos
</code></pre>

<p>The response will be an array of objects: </p>

<pre><code>200 OK
[
  {
    "id": "320d6151a9aad8ce",
    "title": "Wash the dog",
    "category": "pets"
  }, {
    "id": "320d6151a9aad8ce"
    "title": "Write autobiography",
    "category": "writing"
  }
]
</code></pre>

<p>If the collection has no objects, it will be an empty array:</p>

<pre><code>200 OK
[]    
</code></pre></div><div class="section reference"><a name="s-Querying Data-1286"></a><h4>Querying Data <!-- ref --> <a class="anchor-link" href="collections-include=all.html#s-Querying%20Data-1286">#</a></h4>

<p>To filter results by the specified query object, send a <code>GET</code> request to your collection's path with a query string.  See <a href="collections/reference/querying-collections.md.html">Querying Collections</a> for information on constructing a query.</p>

<pre><code>GET /todos?category=pets
</code></pre>

<p>For more advanced queries, you will need to pass the query string as JSON instead:</p>

<pre><code>GET /todos?{"category": "pets"}
</code></pre>

<p>The response body is an array of objects: </p>

<pre><code>200 OK
[
  {
    "id": "320d6151a9aad8ce",
    "title": "Wash the dog",
    "category": "pets"
  }
]
</code></pre></div><div class="section reference"><a name="s-Getting a Specific Object-1286"></a><h4>Getting a Specific Object <!-- ref --> <a class="anchor-link" href="collections-include=all.html#s-Getting%20a%20Specific%20Object-1286">#</a></h4>

<p>To retrieve a single object by its <code>id</code> property, send a <code>GET</code> request with the <code>id</code> value as the path.</p>

<pre><code>GET /todos/320d6151a9aad8ce
</code></pre>

<p>The response body is the object that you requested:</p>

<pre><code>200 OK
{
  "id": "320d6151a9aad8ce",
  "title": "Wash the dog",
  "category": "pets"
}
</code></pre></div><div class="section reference"><a name="s-Creating an Object-1286"></a><h4>Creating an Object <!-- ref --> <a class="anchor-link" href="collections-include=all.html#s-Creating%20an%20Object-1286">#</a></h4>

<p>To create an object in the collection, send a <code>POST</code> request with the object's properties in the body.</p>

<pre><code>POST /todos
{
  "title": "Walk the dog"
}
</code></pre>

<p>The response body is the object that you posted, with any additional calculated properties and the <code>id</code>:</p>

<pre><code>{
  "id": "91c621a3026ca8ef",
  "title": "Walk the dog"
}
</code></pre></div><div class="section reference"><a name="s-Updating an Object-1286"></a><h4>Updating an Object <!-- ref --> <a class="anchor-link" href="collections-include=all.html#s-Updating%20an%20Object-1286">#</a></h4>

<p>To update an object that is already in the collection, send a <code>POST</code> or <code>PUT</code> request with the <code>id</code> value as the path and with the properties you wish to update in the body. It will only change the properties that are provided. It is also possible to incrementally update certain properties; see <a href="collections/reference/updating-objects.md.html">Updating Objects in Collections</a> for details.</p>

<pre><code>PUT /todos/91c621a3026ca8ef
{
  "title": "Walk the cat"
}
</code></pre>

<!--...-->

<pre><code>POST /todos/91c621a3026ca8ef
{
  "title": "Walk the cat"
}
</code></pre>

<p>You can also omit the <code>id</code> in the path if you provide an <code>id</code> property in the body:</p>

<pre><code>PUT /todos
{
  "id": "91c621a3026ca8ef"
  "title": "Walk the cat"
}
</code></pre>

<p>Finally, you can provide a query string to ensure that the object you are updating has the correct properties. You must still provide an <code>id</code>. This can be useful as a failsafe.</p>

<pre><code>PUT /todos/91c621a3026ca8ef?category=pets
{
  "title": "Walk the cat"
}
</code></pre>

<p>The response body is the entire object after the update:</p>

<pre><code>200 OK  
{
  "id": "91c621a3026ca8ef",
  "title": "Walk the cat",
  "category": "pets"
}
</code></pre>

<p>The <code>PUT</code> verb will return an error if the <code>id</code> and/or <code>query</code> does not match any object in the collection:</p>

<pre><code>400 Bad Request
{
  "status": 400,
  "message": "No object exists that matches that query"
}
</code></pre></div><div class="section reference"><a name="s-Deleting an Object-1286"></a><h4>Deleting an Object <!-- ref --> <a class="anchor-link" href="collections-include=all.html#s-Deleting%20an%20Object-1286">#</a></h4>

<p>To delete an object from the collection, send a <code>DELETE</code> request with the <code>id</code> value as a path.</p>

<pre><code>DELETE /todos/91c621a3026ca8ef
</code></pre>

<p>You can also pass a query string to ensure that you are removing the correct object:</p>

<pre><code>DELETE /todos/91c621a3026ca8ef?title=Walk the dog
</code></pre>

<p>You can omit the <code>id</code> in the path if you provide it in the query string:</p>

<pre><code>DELETE /todos?id=91c621a3026ca8ef&amp;title=Walk the dog
</code></pre>

<p>The response body will always be empty.</p></div><div class="section"><a name="s-Realtime API"></a><h3>Realtime API <a class="anchor-link" href="collections-include=all.html#s-Realtime%20API">#</a></h3>

<p>Deployd uses <a href="http://socket.io/#home">Socket.io</a> for its realtime functionality. If you are not using dpd.js, you can use the <a href="https://github.com/LearnBoost/socket.io-client/blob/master/dist/socket.io.js">Socket.io client library</a>. </p>

<pre><code>var socket = io.connect('/');
socket.on('todos:create', function(todo) {
  // Do something
});
</code></pre>

<p>The Socket.io community has created client libraries for other languages and platforms as well.</p></div><div class="section"><a name="s-Root Requests"></a><h3>Root Requests <a class="anchor-link" href="collections-include=all.html#s-Root%20Requests">#</a></h3>

<p>You can elevate your session to root access by adding the header <code>dpd-ssh-key</code>. It must have the value of your app's key (you can find this by typing <code>dpd showkey</code> into the command line); although in the <code>development</code> environment, the <code>dpd-ssh-key</code> header can have any value.</p>

<p>Sending a request as root has several effects. Most notably, you can use the <code>{$skipEvents: true}</code> property in either the query string or request body. This will cause events not to run. This is useful for bypassing authentication or validation. </p>

<p>Your front-end app should never gain root access, and you should never store the app's key in a place where it can be accessed by users, even if they understand the system. This is primarily useful for writing data management utilities for yourself, other developers, and system administrators.</p></div><div class="section"><a name="s-Examples"></a><h3>Examples <a class="anchor-link" href="collections-include=all.html#s-Examples">#</a></h3>

<p>The examples below show how to use various JavaScript front-end libraries to access a Collection called <code>/todos</code>.</p><div class="section"><a name="s-[jQuery](http://jquery.com/)-831"></a><h4><a href="http://jquery.com/">jQuery</a> <a class="anchor-link" href="collections-include=all.html#s-%5BjQuery%5D(http://jquery.com/)-831">#</a></h4>

<pre><code>$.ajax('/todos', {
  type: "GET",
  success: function(todos) {
    // Do something
  },
  error: function(xhr) {
    alert(xhr.responseText);
  }
});

$.ajax('/todos', {
  type: "POST",
  contentType: "application/json",
  data: JSON.stringify({
    title: "Walk the dog"
  }),
  success: function(todo) {
    // Do something
  }, 
  error: function(xhr) {
    alert(xhr.responseText);
  }
});
</code></pre>

<p><em>Note: When providing a request body, jQuery defaults to form encoding. Deployd works best with a JSON body, so you'll need to set the contentType option and manually convert to JSON.</em></p></div><div class="section"><a name="s-[Backbone.js](http://backbonejs.org)-831"></a><h4><a href="http://backbonejs.org">Backbone.js</a> <a class="anchor-link" href="collections-include=all.html#s-%5BBackbone.js%5D(http://backbonejs.org)-831">#</a></h4>

<pre><code>var Todo = Backbone.Model.extend({});
var Todos = Backbone.Collection.extend({
  model: Todo,
  url: "/todos"
});

var todos = new Todos();  

todos.fetch({
  success: function(collection, response) {
    // Do something
  }, error: function(collection, response) {
    alert(response);
  }
});

todos.create({
  title: "Walk the dog"
}, {
  success: function(collection, response) {
    // Do something
  }, error: function(collection, response) {
    alert(response);
  }
});
</code></pre></div><div class="section"><a name="s-[Angular.js](http://angularjs.org/)-831"></a><h4><a href="http://angularjs.org/">Angular.js</a> <a class="anchor-link" href="collections-include=all.html#s-%5BAngular.js%5D(http://angularjs.org/)-831">#</a></h4>

<p>Using <a href="http://docs.angularjs.org/api/ng.$http">$http</a>:</p>

<pre><code>function Controller($scope, $http) {
  $http.get('/todos')
    .success(function(todos) {
      $scope.todos = todos;
    })
    .error(function(err) {
      alert(err);
    });

  $http.post('/todos', {
      title: "Walk the dog"
    })
    .success(function(todo) {
      // Do something
    })
    .error(function(err) {
      alert(err);
    });
}
</code></pre>

<p>Using <a href="http://docs.angularjs.org/api/ngResource.$resource">ngResource</a>:</p>

<pre><code>var myApp = angular.module('myApp', ['ngResource']);

myApp.factory('Todos', function($resource) {
  return $resource('/todos/:todoId', {todoId: '@id'});
});

function Controller($scope, Todos) {
  $scope.todos = Todos.query(function(response) {
    // Do something
  }, function(error) {
    alert(error);
  });

  Todos.save({
    title: "Walk the dog"
  }, function(todo) {
    // Do something
  }, function(error) {
    alert(error);
  });
}

myApp.controller('Controller', Controller);
</code></pre></div><div class="section"><a name="s-Cross-Origin Requests"></a><h3>Cross-Origin Requests <a class="anchor-link" href="collections-include=all.html#s-Cross-Origin%20Requests">#</a></h3>

<p>The most common bug when implementing a CORS client for Deploy is to include headers that are not allowed. A client must not send any custom headers besides the following:</p>

<pre><code>Origin, Accept, Accept-Language, Content-Language, Content-Type, Last-Event-ID
</code></pre>

<p>This will not work on browsers that do not support Cross-Origin Resource Sharing (namely Internet Explorer 7 and below).</p><div class="section"><a name="s-Cross-Origin Requests with dpd.js-2075"></a><h4>Cross-Origin Requests with dpd.js <a class="anchor-link" href="collections-include=all.html#s-Cross-Origin%20Requests%20with%20dpd.js-2075">#</a></h4>

<p>When using dpd.js, all the required CORS headers are sent by default to any domain.  You don't have to make any changes to your requests.  dpd.js takes care of it for you.</p></div><div class="section"><a name="s-Cross-Origin Requests with jQuery-2075"></a><h4>Cross-Origin Requests with jQuery <a class="anchor-link" href="collections-include=all.html#s-Cross-Origin%20Requests%20with%20jQuery-2075">#</a></h4>

<p>When using jQuery.ajax() on cross-origin requests the credentials are not sent along with the request automatically.  You have to add them to each ajax() request using the xhrFields parameter.  Here is an example  of login followed by getting some data.</p>

<pre><code>// Logging a user in.
$.ajax({
  url: 'http://&lt;domain&gt;:&lt;port&gt;/users/login',
  type: "POST",
  data: {username:"un", password:"pw"},
  cache: false,
  xhrFields:{
    withCredentials: true
  },
  success: function(data) {
    console.log(data);
  },
  error: function(xhr) {
    console.log(xhr.responseText);
  }
});

// On subsequent requests or in the success callback above.  (After having logged in) 
$.ajax({
  url: 'http://&lt;domain&gt;:&lt;port&gt;/&lt;collection&gt;',
  type: "GET",
  cache: false,
  xhrFields:{
    withCredentials: true
  },
  success: function(data) {
    console.log(data);
  },
  error: function(xhr) {
    console.log(xhr.responseText);
  }
});
</code></pre></div><div class="section"><a name="s-HTTP method override"></a><h3>HTTP method override <a class="anchor-link" href="collections-include=all.html#s-HTTP%20method%20override">#</a></h3>

<p>Provides faux HTTP method support.</p>

<p>Most browsers doesn’t support methods other than “GET” and “POST” when it comes to submitting forms. So It's support something like 'Rails'.</p>

<p>Pass an optional key to use when checking for a method override, othewise defaults to _method. The original method is available via req.originalMethod.</p>

<p>It's support both URL query and POST body</p>

<pre><code>URL       : ?_method=METHOD_NAME or
JSON body : { _method: 'METHOD_NAME' }
</code></pre>

<p>$.ajax({
            type: "POST",
            url : "/todos/"+ todoId,
            data: { _method:"DELETE" },
            success: function(res) {</p><div class="section"><a name="s-Ajax Example-1889"></a><h4>Ajax Example <a class="anchor-link" href="collections-include=all.html#s-Ajax%20Example-1889">#</a></h4>

<pre><code>$.ajax({
  type : "POST",
  url  : "/todos/OBJECT_ID"
  data : { _method:"DELETE" },
  success: function(todo) {
    // Object was deleted. response body empty.
  }, 
  error: function(xhr) {}
});

or

$.ajax({
  type : "POST",
  url  : "/todos/OBJECT_ID?_method=DELETE",
  success: function(todo) {
    // Object was deleted. response body empty.
  }, 
  error: function(xhr) {}
});
</code></pre></div></div></div></div></div></div><div class="section"><a name="s-Querying Collections"></a><h2>Querying Collections <a class="anchor-link" href="collections-include=all.html#s-Querying%20Collections">#</a></h2><div class="section"><a name="s-Simple Queries-2035"></a><h3>Simple Queries <a class="anchor-link" href="collections-include=all.html#s-Simple%20Queries-2035">#</a></h3>

<p>Collections can be queried over HTTP using the query string.</p>

<p>This example will return all the <code>posts</code> with an author "Joe":</p>

<pre><code>GET /posts?author=Joe   
</code></pre></div><div class="section"><a name="s-Advanced Queries-2035"></a><h3>Advanced Queries <a class="anchor-link" href="collections-include=all.html#s-Advanced%20Queries-2035">#</a></h3>

<p>When querying a <a href="http://localhost:3000/docs/collections/">Collection</a>, you can use special commands to create a more advanced query. </p>

<p>Deployd supports all of <a href="http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-ConditionalOperators">MongoDB's conditional operators</a>; only the common operators and Deployd's custom commands are documented here.</p>

<p>When using an advanced query in REST, you must pass JSON as the query string, for example:</p>

<pre><code>GET /posts?{"likes": {"$gt": 10}}
</code></pre>

<p>If you are using dpd.js, this will be handled automatically.</p><div class="section api"><a name="s-Comparison ($gt, $lt, $gte, $lte)-1556"></a><h4>Comparison ($gt, $lt, $gte, $lte) <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-Comparison%20($gt,%20$lt,%20$gte,%20$lte)-1556">#</a></h4>

<p>Compares a Number property to a given value.</p>

<ul>
<li><code>$gt</code> - Greater than</li>
<li><code>$lt</code> - Less than</li>
<li><code>$gte</code> - Greater than or equal to</li>
<li><p><code>$lte</code> - Less than or equal to</p>

<pre><code>// Finds all posts with more than 10 likes
{
    likes: {$gt: 10}
}
</code></pre></li>
</ul></div><div class="section api"><a name="s-$ne (Not Equal)-1556"></a><h4>$ne (Not Equal) <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-$ne%20(Not%20Equal)-1556">#</a></h4>

<p>The <code>$ne</code> command lets you choose a value to exclude. </p>

<pre><code>// Get all posts except those posted by Bob
{
    author: {$ne: "Bob"}
}
</code></pre></div><div class="section api"><a name="s-$in-1556"></a><h4>$in <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-$in-1556">#</a></h4>

<p>The <code>$in</code> command allows you to specify an array of possible matches.</p>

<pre><code>// Get articles in the "food", "business", and "technology" categories
{
    category: {$in: ["food", "business", "technology"]}
}
</code></pre></div><div class="section api"><a name="s-$regex-1556"></a><h4>$regex <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-$regex-1556">#</a></h4>

<p>The <code>$regex</code> command allows you to specify a <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions">regular expression</a> to match a string property.</p>

<p>You can also use the <code>$options</code> command to specify regular expression flags.</p>

<pre><code>// Get usernames that might be email addresses (x@y.z)
{
    "username": {$regex: "[a-z0-9\-]+@[a-z0-9\-]+\.[a-z0-9\-]+", $options: 'i' }
}
</code></pre></div><div class="section"><a name="s-Query commands"></a><h3>Query commands <a class="anchor-link" href="collections-include=all.html#s-Query%20commands">#</a></h3>

<p>Query commands apply to the entire query, not just a single property.</p><div class="section api"><a name="s-$fields-1416"></a><h4>$fields <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-$fields-1416">#</a></h4>

<p>The <code>$fields</code> command allows you to include or exclude properties from your results.</p>

<pre><code>    // Exclude the "email" property
    {
        $fields: {email: 0}
    }
</code></pre>

<!--...-->

<pre><code>    // Only include the "title" property
    {
        $fields: {title: 1}
    }
</code></pre></div><div class="section api"><a name="s-$or-1416"></a><h4>$or <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-$or-1416">#</a></h4>

<p>The <code>$or</code> command allows you to specify multiple queries for an object to match in an array.</p>

<pre><code>// Get all public posts and all posts by a specified user (even if those are private)
{
    $or: [{
      isPublic: true
    }, {
      creator: "Bob"
    }]
}
</code></pre></div><div class="section api"><a name="s-$sort-1416"></a><h4>$sort <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-$sort-1416">#</a></h4>

<p>The <code>$sort</code> command allows you to order your results by the value of a property. The value can be 1 for ascending sort (lowest first; A-Z, 0-10) or -1 for descending (highest first; Z-A, 10-0)</p>

<pre><code>// Sort posts by likes, descending
{
    $sort: {likes: -1}
}
</code></pre></div><div class="section api"><a name="s-$limit-1416"></a><h4>$limit <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-$limit-1416">#</a></h4>

<p>The <code>$limit</code> command allows you to limit the amount of objects that are returned from a query. This is commonly used for paging, along with <code>$skip</code>.</p>

<pre><code>// Return the top 10 scores
{
    $sort: {score: -1},
    $limit: 10
}
</code></pre></div><div class="section api"><a name="s-$skip-1416"></a><h4>$skip <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-$skip-1416">#</a></h4>

<p>The <code>$skip</code> command allows you to exclude a given number of the first objects returned from a query. This is commonly used for paging, along with <code>$limit</code>. </p>

<pre><code>// Return the third page of posts, with 10 posts per page
{
    $skip: 20,
    $limit: 10
}
</code></pre></div><div class="section api"><a name="s-$limitRecursion-1416"></a><h4>$limitRecursion <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-$limitRecursion-1416">#</a></h4>

<p>The <code>$limitRecursion</code> command allows you to override the default recursive limits in Deployd. This is useful when you want to query a very deeply nested structure of data. Otherwise you can still query nested structures, but Deployd will stop the recursion after 2 levels. See the <a href="collections/relationships-between-collections.md.html">Collection Relationships guide</a> for more info.</p></div></div></div></div><div class="section"><a name="s-Updating Objects in Collections"></a><h2>Updating Objects in Collections <a class="anchor-link" href="collections-include=all.html#s-Updating%20Objects%20in%20Collections">#</a></h2>

<p>When updating an object in a Collection, you can use special modifier commands to more granularly change property values. </p><div class="section api"><a name="s-$inc-3004"></a><h3>$inc <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-$inc-3004">#</a></h3>

<p>The <code>$inc</code> command increments the value of a given Number property.</p>

<pre><code>// Give a player 5 points
{
  score: {$inc: 5}
}
</code></pre></div><div class="section api"><a name="s-$push-3004"></a><h3>$push <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-$push-3004">#</a></h3>

<p>The <code>$push</code> command adds a value to an Array property.</p>

<pre><code>// Add a follower to a user by storing their id.
{
  followers: {$push: 'a59551a90be9abd8'}
}
</code></pre></div><div class="section api"><a name="s-$pushAll-3004"></a><h3>$pushAll <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-$pushAll-3004">#</a></h3>

<p>The <code>$pushAll</code> command adds multiple values to an Array property.</p>

<pre><code>// Add mentions of users
{
  mentions: {
    $pushAll: ['a59551a90be9abd8', 'd0be45d1445d3809']
  }
}
</code></pre></div><div class="section api"><a name="s-$pull-3004"></a><h3>$pull <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-$pull-3004">#</a></h3>

<p>The <code>$pull</code> command removes a value from an Array property.</p>

<pre><code>// Remove a user from followers
{
  followers: {$pull: 'a59551a90be9abd8'}
}
</code></pre>

<p><em>Note: If there is more than one matching value in the Array, this will remove all of them</em></p></div><div class="section api"><a name="s-$pullAll-3004"></a><h3>$pullAll <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-$pullAll-3004">#</a></h3>

<p>The <code>$pullAll</code> command removes multiple values from an Array property.</p>

<pre><code>// Remove multiple users
{
  followers: {$pullAll: ['a59551a90be9abd8', 'd0be45d1445d3809']}
}
</code></pre>

<p><em>Note: This will remove all of the matching values from the Array</em></p></div></div><div class="section"><a name="s-Dpd.js"></a><h2>Dpd.js <a class="anchor-link" href="collections-include=all.html#s-Dpd.js">#</a></h2>

<p><code>dpd.js</code> is an auto-generated library that provides access to Collections and other Deployd features on the front-end. For a basic overview, see <a href="collections/accessing-collections.md.html">Accessing Collections with dpd.js</a>.</p><div class="section"><a name="s-Accessing the Collection-547"></a><h3>Accessing the Collection <a class="anchor-link" href="collections-include=all.html#s-Accessing%20the%20Collection-547">#</a></h3>

<p>The API for your Collection is automatically generated as <code>dpd.[collectionname]</code>.</p>

<p>Examples:</p>

<pre><code>dpd.todos
dpd.users
dpd.todolists
</code></pre>

<p><em>Note: If your Collection name has a dash in it (e.g. <code>/todo-lists</code>), the dash is removed when accessing it in this way (e.g. <code>dpd.todolists</code>).</em></p>

<p>You can also access your collection by using <code>dpd(collectionName)</code> as a function.</p>

<p>Examples:</p>

<pre><code>dpd('todos')
dpd('users')
dpd('todo-lists')
</code></pre>

<p><em>Note: Collections accessed in this way will not have helper functions besides <code>get</code>, <code>post</code>, <code>put</code>, <code>del</code>, and <code>exec</code> (see <a href="using-modules/reference/dpd-js.md.html">Dpd.js for Custom Resources</a> for details on these generic functions)</em></p></div><div class="section"><a name="s-Collection API-547"></a><h3>Collection API <a class="anchor-link" href="collections-include=all.html#s-Collection%20API-547">#</a></h3>

<p>The examples below use a Collection called <code>/todos</code> with the following schema:</p>

<ul>
<li><code>id</code></li>
<li>string <code>title</code></li>
<li>string <code>category</code></li>
</ul><div class="section"><a name="s-Callbacks-1286"></a><h4>Callbacks <a class="anchor-link" href="collections-include=all.html#s-Callbacks-1286">#</a></h4>

<p>Every function in the Collection API takes a callback function (represented by <code>fn</code> in the docs) with the signature <code>function(result, error)</code>.</p>

<p>The callback will be executed asynchronously when the API has received a response from the server. </p>

<p>The <code>result</code> argument differs depending on the function. If the result failed, it will be <code>null</code> and the <code>error</code> argument will contain the error message.</p>

<p>The <code>error</code> argument, if there was an error, is an object:</p>

<ul>
<li><code>status</code> (number): The HTTP status code of the request. Common codes include:
<ul><li>400 - Bad Request: The request contained invalid data and could not be completed</li>
<li>401 - Unauthorized: The current session is not authorized to perform that action</li>
<li>500 - Internal Server Error: Something went wrong on the server</li></ul></li>
<li><code>message</code> (string): A message describing the error. Not always present.</li>
<li><code>errors</code> (object): A hash of error messages corresponding to the properties of the object that were sent - usually indicates validation errors. Not always present.</li>
</ul>

<p>Examples of errors:</p>

<pre><code>{
  "status": 401,
  "message": "You are not allowed to access that collection!"
}
</code></pre>

<!--...-->

<pre><code>{
  "status": 400,
  "errors": {
      "title": "Title must be less than 100 characters",
      "category": "Not a valid category"
  }
}
</code></pre></div><div class="section api"><a name="s-.get([id], [query], fn)-1286"></a><h4>.get([id], [query], fn) <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-.get(%5Bid%5D,%20%5Bquery%5D,%20fn)-1286">#</a></h4><div class="section"><a name="s-Listing Data-1950"></a><h5>Listing Data <a class="anchor-link" href="collections-include=all.html#s-Listing%20Data-1950">#</a></h5>

<p>The <code>.get(fn)</code> function returns an array of objects in the collection.</p>

<pre><code>// Get all todos
dpd.todos.get(function(results, error) {
  //Do something
});
</code></pre>

<p><code>results</code> is an array of objects: </p>

<pre><code>[
  {
    "id": "320d6151a9aad8ce",
    "title": "Wash the dog",
    "category": "pets"
  }, {
    "id": "320d6151a9aad8ce"
    "title": "Write autobiography",
    "category": "writing"
  }
]
</code></pre>

<p>If the collection has no objects, it will be an empty array:</p>

<pre><code>[]    
</code></pre></div><div class="section"><a name="s-Querying Data-1950"></a><h5>Querying Data <a class="anchor-link" href="collections-include=all.html#s-Querying%20Data-1950">#</a></h5>

<p>The <code>.get(query, fn)</code> function filters results by the specified query object. See <a href="collections/reference/querying-collections.md.html">Querying Collections</a> for information on constructing a query.</p>

<pre><code>// Get all todos that are in the pets category
dpd.todos.get({category: 'pets'}, function(results, error) {
  // Do something
});
</code></pre>

<p><code>results</code> is an array of objects: </p>

<pre><code>[
  {
    "id": "320d6151a9aad8ce",
    "title": "Wash the dog",
    "category": "pets"
  }
]
</code></pre></div><div class="section"><a name="s-Getting a Specific Object-1950"></a><h5>Getting a Specific Object <a class="anchor-link" href="collections-include=all.html#s-Getting%20a%20Specific%20Object-1950">#</a></h5>

<p>The <code>.get(id, fn)</code> function returns a single object by its <code>id</code> property.</p>

<pre><code>// Get a specific todo
dpd.todos.get("320d6151a9aad8ce", function(result, error) {
  // Do something
});
</code></pre>

<p><code>result</code> is the object that you requested:</p>

<pre><code>{
  "id": "320d6151a9aad8ce",
  "title": "Wash the dog",
  "category": "pets"
}
</code></pre></div><div class="section api"><a name="s-.post([id], object, fn)"></a><h4>.post([id], object, fn) <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-.post(%5Bid%5D,%20object,%20fn)">#</a></h4><div class="section"><a name="s-Creating an Object-1965"></a><h5>Creating an Object <a class="anchor-link" href="collections-include=all.html#s-Creating%20an%20Object-1965">#</a></h5>

<p>The <code>.post(object, fn)</code> function creates an object in the collection with the specified properties. </p>

<pre><code>// Create a todo
dpd.todos.post({title: "Walk the dog"}, function(result, error)) {
  // Do something
});
</code></pre>

<p><code>result</code> is the object that you posted, with any additional calculated properties and the <code>id</code>:</p>

<pre><code>{
  "id": "91c621a3026ca8ef",
  "title": "Walk the dog"
}
</code></pre></div><div class="section"><a name="s-Updating an Object-1965"></a><h5>Updating an Object <a class="anchor-link" href="collections-include=all.html#s-Updating%20an%20Object-1965">#</a></h5>

<p>The <code>.post(id, object, fn)</code> function, or <code>.post(object, fn)</code> where <code>object</code> has an <code>id</code> property, will update an object. Using the <code>.post()</code> function in this way behaves the same as the <code>put()</code> function.</p>

<p>This is useful when you want to insert an object if it does not exist and update it if it does.</p></div><div class="section api"><a name="s-.put([id or query], object, fn)"></a><h4>.put([id or query], object, fn) <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-.put(%5Bid%20or%20query%5D,%20object,%20fn)">#</a></h4><div class="section"><a name="s-Updating an Object-2711"></a><h5>Updating an Object <a class="anchor-link" href="collections-include=all.html#s-Updating%20an%20Object-2711">#</a></h5>

<p>The <code>.put(id, object, fn)</code> function will update an object that is already in the collection. It will only change the properties that are provided. It is also possible to incrementally update certain properties; see <a href="collections/reference/updating-objects.md.html">Updating Objects in Collections</a> for details.</p>

<pre><code>// Update a todo
dpd.todos.put("91c621a3026ca8ef", {title: "Walk the cat"}, function(result, error)) {
  // Do something
});
</code></pre>

<p>You can also use the syntax <code>put(object, fn)</code> if <code>object</code> has an <code>id</code> property:</p>

<pre><code>// Update a todo
dpd.todos.put({id: "91c621a3026ca8ef", title: "Walk the cat"}, function(result, error)) {
  // Do something
});
</code></pre>

<p>Finally, you can provide a <code>query</code> object to ensure that the object you are updating has the correct properties. You must still provide an <code>id</code> property. This can be useful as a failsafe.</p>

<pre><code>// Update a todo only if it is in the "pets" category
dpd.todos.put(
  {id: "91c621a3026ca8ef", category: "pets"},
  {title: "Walk the cat"},
  function(result, error) {
    // Do something
  });
</code></pre>

<p><code>result</code> is the entire object after the update:</p>

<pre><code>{
  "id": "91c621a3026ca8ef",
  "title": "Walk the cat",
  "category": "pets"
}
</code></pre>

<p>The <code>.put()</code> function will return an error if the <code>id</code> and/or <code>query</code> does not match any object in the collection:</p>

<pre><code>{
  "status":400,
  "message":"No object exists that matches that query"
}
</code></pre></div><div class="section api"><a name="s-.del(id or query, fn)"></a><h4>.del(id or query, fn) <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-.del(id%20or%20query,%20fn)">#</a></h4><div class="section"><a name="s-Deleting an Object-1784"></a><h5>Deleting an Object <a class="anchor-link" href="collections-include=all.html#s-Deleting%20an%20Object-1784">#</a></h5>

<p>The <code>.del(id, fn)</code> function will delete an object from the collection.</p>

<pre><code>// Delete an object
dpd.todos.del("91c621a3026ca8ef", function(result, error) {
  // Do something
});
</code></pre>

<p>You can also use the syntax <code>.del(query, fn)</code> if <code>object</code> has an <code>id</code> property. You can add additional properties to the <code>query</code> object to ensure that you are removing the correct object:</p>

<pre><code>// Delete an object
dpd.todos.del({id: "91c621a3026ca8ef", title: "Walk the dog"}, function(result, error) {
  // Do something
});
</code></pre>

<p><code>result</code> will always be null.</p></div></div></div></div></div></div></div><div class="section"><a name="s-Realtime API"></a><h3>Realtime API <a class="anchor-link" href="collections-include=all.html#s-Realtime%20API">#</a></h3><div class="section api"><a name="s-dpd.on(message, fn)-1069"></a><h4>dpd.on(message, fn) <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-dpd.on(message,%20fn)-1069">#</a></h4>

<p>The <code>dpd.on(message, fn)</code> function listens for realtime messages emitted from the server. See <a href="collections/notifying-clients.md.html">Notifying the Client of Changes</a> for information on sending realtime messages with the <code>emit()</code> function.</p>

<ul>
<li><code>message</code> - The name of the message to listen for</li>
<li><code>fn</code> - Callback <code>function(messageData)</code>. Called every time the message is received. There is no <code>error</code> argument.</li>
</ul>

<!--seperate-->

<pre><code>// Listen for a new todo
dpd.on('todos:create', function(post) {
  // Do something
});
</code></pre>

<p>In your Collection Event:</p>

<pre><code>// On Post
emit('todos:create', this); 
</code></pre>

<p>Calling <code>.on()</code> on the collection itself will namespace the message by the collection name:</p>

<pre><code>// Same as dpd.on('todos:create', fn)
dpd.todos.on('create', function(post) {
  // Do something
});
</code></pre></div><div class="section api"><a name="s-dpd.off(message, [fn])-1069"></a><h4>dpd.off(message, [fn]) <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-dpd.off(message,%20%5Bfn%5D)-1069">#</a></h4>

<p>The <code>dpd.off(message)</code> function stops listening for the specified message.</p>

<pre><code>dpd.off('todos:create');
</code></pre>

<p>You can also provide a function that was originally set as a listener to remove only that function.</p>

<pre><code>function onTodoCreated(post) {
  // Do something
}

dpd.on('todos:create', onTodoCreated);

dpd.off('todos:create', onTodoCreated);
</code></pre>

<p>Calling <code>.off()</code> on the collection itself will namespace the message by the collection name:</p>

<pre><code>// Same as dpd.off('todos:create');
dpd.todos.off('create');
</code></pre></div><div class="section api"><a name="s-dpd.once(message, fn)-1069"></a><h4>dpd.once(message, fn) <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-dpd.once(message,%20fn)-1069">#</a></h4>

<p>The <code>dpd.once(message, fn)</code> function listens for a realtime message emitted by the server and runs the <code>fn</code> callback exactly once.</p>

<pre><code>dpd.once('todos:create', function(post) {
  // Do something
});
</code></pre>

<p>Calling <code>.once()</code> on the collection itself will namespace the message by the collection name:</p>

<pre><code>// Same as dpd.once('todos:create');
dpd.todos.once('create', function(post) {
  // Do something
});
</code></pre></div><div class="section api"><a name="s-dpd.socketReady(fn)-1069"></a><h4>dpd.socketReady(fn) <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-dpd.socketReady(fn)-1069">#</a></h4>

<p>The <code>dpd.socketReady(fn)</code> function waits for a connection to be established to the server and executes the <code>fn</code> callback with no arguments. If a connection has already been established, it will execute the <code>fn</code> callback immediately. </p>

<p>It can sometimes take a second or more to establish a connection, and messages sent during this time will not be received by your front end. This function is useful for ensuring that you will receive an message when it is broadcast.</p>

<pre><code>dpd.socketReady(function() {
  // Do something
});
</code></pre></div><div class="section api"><a name="s-dpd.socket-1069"></a><h4>dpd.socket <!-- api --> <a class="anchor-link" href="collections-include=all.html#s-dpd.socket-1069">#</a></h4>

<p>The <code>dpd.socket</code> object is a <a href="http://socket.io/#how-to-use">socket.io</a> object. This is useful if you want to finely control how messages are received.</p></div></div>  

      
        

  <div class="section"><a name="s-Collections"></a><h2>Collections <a class="anchor-link" href="collections-include=all.html#s-Collections">#</a></h2>

<p>The most commonly used resource in a Deployd app is the Collection. It exposes a database like API that allows any client to query, modify and sync the data in your app, all without having to write a ton of boilerplate code on the server.</p><div class="section"><a name="s-Properties-1151"></a><h3>Properties <a class="anchor-link" href="collections-include=all.html#s-Properties-1151">#</a></h3>

<p>Collection properties allow you to restrict what type of data a collection can store. You define them using the <strong>property editor</strong> in the dashboard. </p>

<p><img src="../images/property-editor.png" alt="Property Editor" title="" /></p></div><div class="section"><a name="s-Data-1151"></a><h3>Data <a class="anchor-link" href="collections-include=all.html#s-Data-1151">#</a></h3>

<p>Collection's use JSON to store and transport your objects over the wire. Deployd comes bundled with a fully featured <strong>data-editor</strong> for easily managing the data in your collection.</p></div><div class="section"><a name="s-Events-1151"></a><h3>Events <a class="anchor-link" href="collections-include=all.html#s-Events-1151">#</a></h3>

<p><a href="collections/adding-logic.md.html">Control the behavior and business logic</a> of the data in your collection by writing events. Events also allow you to easily create <a href="collections/relationships-between-collections.md.html">relationships between collections</a>.</p></div><div class="section"><a name="s-Notifying Clients of Changes-1151"></a><h3>Notifying Clients of Changes <a class="anchor-link" href="collections-include=all.html#s-Notifying%20Clients%20of%20Changes-1151">#</a></h3>

<p>Deployd allows you to <a href="collections/notifying-clients.md.html">send messages to the browser in real time</a> when a Collection is updated.</p></div></div>  

      
    
    <h3 style="text-align: center;">More</h3>

    
    
    <div class="row-fluid">
      <div class="span6">
        <div class="well">
          <h4>Other docs in "Docs"</h4>
          <ul>
            
              <li><a href="getting-started/what-is-deployd.md.html">Getting Started</a></li>
            
              <li><a href="basics/cli.md.html">Basics</a></li>
            
              <li><a href="users/creating-user-collections.md.html">Users</a></li>
            
              <li><a href="using-modules/installing-modules.md.html">Using Modules</a></li>
            
              <li><a href="server/as-a-node-module.md.html">The Deployd Server</a></li>
            
              <li><a href="developing-modules/creating-modules.md.html">Developing Modules</a></li>
            
          </ul>
        </div>
      </div>
       
        <div class="span6">
          <div class="well">
            <h4>Related Examples</h4>
            <ul>
              
                <li><a href="collections/examples/a-simple-todo-app.md.html">A Simple Todo App</a></li>
              
                <li><a href="collections/examples/a-simple-todo-app-with-angular.md.html">A Simple Todo App with AngularJS</a></li>
              
                <li><a href="collections/examples/a-simple-todo-app-with-backbone.md.html">A Simple Todo App with Backbone.js</a></li>
              
                <li><a href="collections/examples/chatroom.md.html">Chatroom</a></li>
              
            </ul>
          </div>
        </div>
      
    </div>
  </div>
</div>
    </div>
    
    <div class="docs-nav">
      <div class="container">
        <div class="row">
          <div class="span3">
            <h3>Guides</h3>
            <ul class="nav nav-list">
              
                <li><a href="getting-started/what-is-deployd.md.html">Getting Started</a></li>
              
                <li><a href="basics/cli.md.html">Basics</a></li>
              
                <li><a href="collections/creating-collections.md.html">Collections</a></li>
              
                <li><a href="users/creating-user-collections.md.html">Users</a></li>
              
                <li><a href="using-modules/installing-modules.md.html">Using Modules</a></li>
              
                <li><a href="server/as-a-node-module.md.html">The Deployd Server</a></li>
              
                <li><a href="developing-modules/creating-modules.md.html">Developing Modules</a></li>
              
            </ul>
          </div>
          <div class="span3">
            <h3>APIs</h3>
            <ul class="nav nav-list">
              
                <li class="nav-header"><a href="collections/reference/event-api.md.html">Collections</a></li>
                
                  <li><a href="collections/reference/event-api.md.html">Event API</a></li>
                
                  <li><a href="collections/reference/http.md.html">Over HTTP</a></li>
                
                  <li><a href="collections/reference/querying-collections.md.html">Querying Collections</a></li>
                
                  <li><a href="collections/reference/updating-objects.md.html">Updating Objects in Collections</a></li>
                
                  <li><a href="collections/reference/dpd-js.md.html">Using dpd.js</a></li>
                
              
                <li class="nav-header"><a href="using-modules/reference/dpd-js.md.html">Using Modules</a></li>
                
                  <li><a href="using-modules/reference/dpd-js.md.html">Dpd.js for Custom Resources</a></li>
                
                  <li><a href="using-modules/reference/event-api.md.html">Event API for Custom Resources</a></li>
                
              
                <li class="nav-header"><a href="developing-modules/internal-api/collection.md.html">Developing Modules</a></li>
                
                  <li><a href="developing-modules/internal-api/collection.md.html">Collection Resource Type</a></li>
                
                  <li><a href="developing-modules/internal-api/context.md.html">Context</a></li>
                
                  <li><a href="developing-modules/internal-api/script.md.html">Event Scripts</a></li>
                
                  <li><a href="developing-modules/internal-api/internal-client.md.html">Internal Client</a></li>
                
                  <li><a href="developing-modules/internal-api/resource.md.html">Resource Types</a></li>
                
                  <li><a href="developing-modules/internal-api/server.md.html">Server</a></li>
                
                  <li><a href="developing-modules/internal-api/session.md.html">Session</a></li>
                
                  <li><a href="developing-modules/internal-api/session-store.md.html">Session Store</a></li>
                
                  <li><a href="developing-modules/internal-api/store.md.html">Store</a></li>
                
                
            </ul>
          </div>
          <div class="span3">
            <h3>Examples</h3>
            <ul class="nav nav-list">
              
                <li class="nav-header"><a href="collections/creating-collections.md.html">Collections</a></li>
                
                  <li><a href="../index.html">A Simple Todo App</a></li>
                
                  <li><a href="../index.html">A Simple Todo App with AngularJS</a></li>
                
                  <li><a href="../index.html">A Simple Todo App with Backbone.js</a></li>
                
                  <li><a href="../index.html">Chatroom</a></li>
                
              
                <li class="nav-header"><a href="users/creating-user-collections.md.html">Users</a></li>
                
                  <li><a href="../index.html">Microblogging app</a></li>
                
                  <li><a href="../index.html">Simple Login Form</a></li>
                
              
                <li class="nav-header"><a href="developing-modules/creating-modules.md.html">Developing Modules</a></li>
                
                  <li><a href="../index.html">Email Resource</a></li>
                
                  <li><a href="../index.html">Event Resource</a></li>
                
                  <li><a href="../index.html">S3 Bucket Resource</a></li>
                
                
            </ul>
          </div>
          <div class="span3">
            <div id="feedback">
              <h3>Feedback</h3>
              <p>Let us know if you have any ideas to improve our docs. Open an <a href="https://github.com/deployd/docs/issues">issue on github</a>, <a href="mailto: hello@deployd.com">send us an email</a>, or <a href="https://twitter.com/deploydapp">tweet us</a>.</p>
            </div>
            <div id="download">
              <h3>Edit or Download these Docs</h3>
              <p>This entire site, including documentation written in markdown is <a href="https://github.com/deployd/docs">available on github</a>. Pull requests are appreciated!</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer>
      <div class="container">
        <div class="row">
          <div class="span navigation">
            <dl>
              <dt><img src="http://deployd.com/img/footer-dt.png" alt="deployd"></dt>
              <dd><a href="http://deployd.com/">Home</a></dd>
              <dd><a href="http://deployd.com/video.html">Screencast</a></dd>
              <dd><a href="http://deployd.com/features.html">Features</a></dd>
              <dd><a href="https://github.com/deployd/deployd/issues">Support</a></dd>
            </dl>
            <dl>
              <dt>documentation</dt>
              <dd><a href="http://docs.deployd.com/guides">Guides</a></dd>
              <dd><a href="http://docs.deployd.com/api">API</a></dd>
              <dd><a href="http://docs.deployd.com/examples">Examples</a></dd>
              <dd><a href="http://docs.deployd.com/modules">Modules</a></dd>
            </dl>
            <dl>
              <dt>community</dt>
              <dd><a href="http://deployd.com/community.html">Questions</a></dd>
              <dd><a href="https://twitter.com/deploydapp">Tweets</a></dd>
              <dd><a href="https://github.com/deployd/deployd/issues">Issues</a></dd>
              <dd><a href="https://github.com/deployd/deployd">Github</a></dd>
            </dl>
            <dl>
              <dt>contact</dt>
              <dd><a href="mailto:hello@deployd.com">hello@deployd.com</a></dd>
            </dl>
          </div>
          <div class="span logo-container">
            <div class="logo">
              <img src="http://deployd.com/img/footer-logo.png" alt="deployd">
            </div>
          </div>
          <div class="span email-container">
            <dl id="mc_embed_signup" class="span4">
            <dt>Get deployd emails</dt>
            <dd>
              <form action="http://deployd.us2.list-manage.com/subscribe/post?u=4f1b944ba8c90738eb8e3fa3c&amp;id=7bb18e6b80" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate form-vertical" target="_blank" novalidate="">
              <div class="mc-field-group">
                <input type="email" placeholder="your@email" value="" name="EMAIL" class="required email" id="mce-EMAIL"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button btn">
              </div>
                <div id="mce-responses" class="clear">
                  <div class="response" id="mce-error-response" style="display:none"></div>
                  <div class="response" id="mce-success-response" style="display:none"></div>
                </div>
              </form>
            </dd>
          </dl>
          </div>
        </div>
      </div>
    </footer>
    <script src="../javascripts/app.js"></script>
  </body>
</html>